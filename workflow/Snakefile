# load packages

import pandas as pd
import os
from snakemake.utils import validate
from snakemake.utils import min_version

min_version("9.5.1")

# configuration
configfile: "../config/config.yaml"

# load samples
parameters = pd.read_table(
    "../config/parameters.tsv", sep="\t", dtype={"ID": str}
).set_index(["ID"], drop=False)

reads = pd.read_table(
    "../config/reads.tsv", sep="\t", dtype={"sample": str}
).set_index(["sample"], drop=False)

rule all_sims:
    input:
        expand("slim_results/{ID}_neutfreqs.tsv", ID=parameters["ID"])

rule all_poolseq:
    input:
        expand("freqk_call_results/{sample}.txt", sample=reads["sample"])

rule all_seed_mix:
    input:
        expand("freqk_call_results/{sample}.txt", sample=config["seed_samples"])

#rule all:
#    input:
        #expand("fastp_results/trimmed_paired_R1_{ID}.fastq.gz", ID = config["samples"]),
#        "multiqc_report.html",
        #expand("kmc_results/after_{sample}.txt", sample = parameters.loc[parameters["experiment"] == "adaptest", "sample"])        
#        expand("samtools_results/{sample}.txt", sample = parameters.loc[parameters["experiment"] == "benchmark", "sample"]),
        #expand("varscan_results/{ID}.tsv", ID = config["samples"])

include: "rules/freqk.smk"
include: "rules/fastp.smk"
include: "rules/msprime.smk"
#include: "rules/kmc.smk"
#include: "rules/kmc_contam_db.smk"
#include: "rules/kmc_rm_contam.smk"
#include: "rules/kmc_filter.smk"
#include: "rules/multiqc.smk"
#include: "rules/bwa_index.smk"
#include: "rules/bwa_mem.smk"
#include: "rules/samtools.smk"
#include: "rules/varscan.smk"
